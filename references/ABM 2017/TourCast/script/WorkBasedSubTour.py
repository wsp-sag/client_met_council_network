####################################################################
# WorkBasedSubTour.py
# other notes:
#   I am not adhering to the python convention of 70-odd columns per line
####################################################################
from Globals import * 

from WorkBasedSubTourDataReferences import *

# the name of the corresponding class on the C# side:
# this allows for multiple scripts targeting the same component
modelComponentName="WorkBasedSubTour"


# Matrices are different enough to require their own structure:
matrixReferences = [
# for now none
]


# ######################  model structure section  ##########################

altIntrinsicValues= [0, 1, 4, 3, 2, 8, 56, 61, 6, 10, 59, 5, 7, 11, 15, 16, 57, 9, 62, 60 ]    ##Work tour Gens were tacked on, hence the odd numbering

# not used thus far:
# friendly descriptions of the alternatives, maybe for UI display somehow
altNames = [ "None", "OneMeal", "OneSocRec", "OnePersBus", "OneShopping", 				# 0-4
			 "OneMealOnePersBus", "OneWork", "TwoWork", "TwoMeal", "OneMealOneEscort",  # 5-9
			 "OneWorkOnePersBus", "OneEscort", "OneMealOneShopping", "TwoShopping", "TwoPersBus", # 10-14
			 "OnePersBusOneSocRec", "OneWorkOneMeal", "OneMealOneSocRec", "OneWorkOneSocRec", "OneWorkOneEsc"  # 15-19
            ]

# this should evolve into a specification (in general) a tree structure
logitType = "NestedLogit"

# nest structure
#   [UI name, nestID, nest coeff, [alts], [nests]]
# where [alts] refers to alternatives by its order in altIntrinsicValues (which in turn
# and [nests] is a list of nestIDs
nestList=[ # UI name, 		nestID,coeff, [alts], 				[nests]
          ["root",      		0, 1.0, [],						[1, 2, 3, 4]],  # has 4 nests underneath,
          ["NoTours", 			1, 1.0, [0],					[]], 
          ["MealTours", 		2, 1.0, [1, 5, 8, 9, 12, 17],	[]], 
          ["WorkRelatedTours", 	3, 1.0, [6, 7, 10, 16, 18, 19],	[]],
          ["OtherTours", 		4, 1.0, [2, 3, 4, 11, 13, 14, 15],[]], 
         ]

#Sorry about the length
					#  0trs,      1ml,       1sc,       1pb,       1sh,       1ml&1pb,   1wk,       2wk,       2ml,       1ml&1es,   1wk&1pb,   1es,       1ml&1sh,   2sh,       2pb,       1pb&1sr,   1wk&1ml,   1ml&1sr,   1wk&1sr,   1wk&1es  
#altSpecificConsts=[   0.00000,  -4.42871,  -4.42871,  -4.42871,  -4.42871,  -8.68117,  -4.42871,  -8.68117,  -8.68117,  -8.68117,  -8.68117,  -4.42871,  -8.68117,  -8.68117,  -8.68117,  -8.68117,  -8.68117,  -8.68117,  -8.68117,  -8.68117]
#altSpecificConsts=[   0.00000,  -4.92871,  -4.92871,  -4.92871,  -5.42871,  -9.68117,  -4.42871,  -8.68117,  -9.68117,  -9.68117,  -9.18117,  -4.92871,  -10.18117,  -10.68117,  -9.68117,  -9.68117,  -9.18117,  -9.68117,  -9.18117,  -9.18117]
#altSpecificConsts=[   0.00000,  -4.82871,  -4.82871,  -4.82871,  -5.42871,  -9.48117,  -4.52871,  -8.88117,  -9.48117,  -9.48117,  -9.18117,  -4.82871,  -10.08117,  -10.68117,  -9.48117,  -9.48117,  -9.18117,  -9.48117,  -9.18117,  -9.18117]
#altSpecificConsts=[   0.00000,  -5.17871,  -5.17871,  -5.32871,  -5.77871,  -10.33117,  -4.52871,  -8.88117,  -10.18117,  -10.33117,  -9.68117,  -5.32871,  -10.78117,  -11.38117,  -10.48117,  -10.33117,  -9.53117,  -10.18117,  -9.53117,  -9.68117]
#altSpecificConsts=[   0.00000,  -5.27871,  -5.17871,  -5.52871,  -5.77871,  -10.63117,  -4.52871,  -8.88117,  -10.38117,  -10.63117,  -9.88117,  -5.52871,  -10.88117,  -11.38117,  -10.88117,  -10.53117,  -9.63117,  -10.28117,  -9.53117,  -9.88117]
#altSpecificConsts=[   0.00000,  -5.27871,  -5.17871,  -5.72871,  -5.82871,  -10.83117,  -4.54871,  -8.92117,  -10.38117,  -10.83117,  -10.10117,  -5.72871,  -10.93117,  -11.48117,  -11.28117,  -10.73117,  -9.65117,  -10.28117,  -9.55117,  -10.10117]
altSpecificConsts=[   0.00000,  -5.27543,  -5.22338,  -5.74702,  -5.82871,  -10.8462,  -4.56522,  -8.95419,  -10.3746,  -10.7699,  -10.136,  -5.67072,  -10.92789,  -11.48117,  -11.3178,  -10.79415,  -9.6644,  -10.32255,  -9.61235,  -10.05969]


durableCoeffs=[
	[placeholder] * 20 # HH Income
 ]

transientCoeffs=[
 [placeholder] * 20, # Previous Mode
 [placeholder] * 20, # Person Type
#  0trs,      1ml,       1sc,       1pb,       1sh,       1ml&1pb,   1wk,       2wk,       2ml,       1ml&1es,   1wk&1pb,   1es,       1ml&1sh,   2sh,       2pb,       1pb&1sr,   1wk&1ml,   1ml&1sr,   1wk&1sr,   1wk&1es  
[  0.000000,  0.182876,  0.049803, -0.128208, -0.186386,  0.054668,  0.810864,  1.621728,  0.993740, -0.020894,  0.682656, -0.203770, -0.003510,  0.624478,  0.682656, -0.078405,  0.993740,  0.232679,  0.860667,  0.607093], # 2 MALE #  
[  0.000000,  0.000000,  0.000000,  0.000000,  0.000000,  0.000000,  0.000000,  0.000000,  0.000000,  2.065835,  0.000000,  2.065835,  0.000000,  0.000000,  0.000000,  0.000000,  0.000000,  0.000000,  0.000000,  2.065835], # 3 2MND_PAT #  2 Mandatory Tours in Day
[  0.000000, -0.711513, -0.711513, -0.711513, -0.711513, -1.423027, -0.711513, -1.423027, -1.423027, -1.423027, -1.423027, -0.711513, -1.423027, -1.423027, -1.423027, -1.423027, -1.423027, -1.423027, -1.423027, -1.423027], # 4 NWORK # Number of Work Tours for Person
[  0.000000,  0.731618,  0.731618,  0.731618,  0.731618,  1.463237,  0.731618,  1.463237,  1.463237,  1.463237,  1.463237,  0.731618,  1.463237,  1.463237,  1.463237,  1.463237,  1.463237,  1.463237,  1.463237,  1.463237], # 5 NPSESC # Number of School Escorting Tours for Person
[  0.000000, -0.111968, -0.111968, -0.278507, -0.111968, -0.390475, -0.111968, -0.223937, -0.223937, -1.043236, -0.390475, -0.931268, -0.223937, -0.223937, -0.390475, -0.390475, -0.223937, -0.223937, -0.223937, -1.043236], # 6 LOG(1+H2WSRDIST) # Log (1 + Travel Distance from Home to Work)
[   0.00000,  0.07549,  0,  0,  0,  0.07549,  0,  0,  0.07549,  0.07549,  0,  0,  0.07549,  0,  0,  0,  0.07549,  0.07549,  0,  0], # 7 REHWYACC10 # Hwy Accessibility to Retail Employment in Work Zone
[   0.00000,  0.09229,  0.09229,  0.27763,  0.09229,  0.36992,  0.04229,  0.08459,  0.18459,  0.23459,  0.31992,  0.14229,  0.18459,  0.18459,  0.41992,  0.36992,  0.13459,  0.18459,  0.13459,  0.18459], # 8 NEHWYACC10 # Hwy Accessibility to Non-Retail Employment in Work Zone
[  0.000000,  0.437221,  0.322969,  0.000000,  0.566243,  0.437221,  0.206603,  0.206603,  0.437221,  0.437221,  0.206603,  0.000000,  1.003464,  0.566243,  0.000000,  0.322969,  0.643824,  0.760190,  0.529572,  0.206603], # 9 LOG(1+PAR_TR) # ln(1 + Duration of Parent Tour in half-hour periods)
[  0.000000, -0.249774, -0.249774, -0.249774, -0.249774, -0.499548, -0.249774, -0.499548, -0.499548, -0.499548, -0.499548, -0.249774, -0.499548, -0.499548, -0.499548, -0.499548, -0.499548, -0.499548, -0.499548, -0.499548], # 10 MAX(0,19-DEPPER2) # Number of Half-Hour Periods Earlier than Noon that Parent Tour Departs (0 if departure after noon)
[  0.000000, -0.773785, -0.773785, -0.773785, -0.773785, -1.547570, -0.205063, -0.978848, -1.547570, -1.547570, -0.978848, -0.773785, -1.547570, -1.547570, -1.547570, -1.547570, -0.978848, -1.547570, -0.978848, -0.978848], # 11 MAX(0,ARRPER2-18) # Number of Half-Hour Periods After Noon that Parent Tour Arrives (0 if arrival before noon)
]

durableCoeffMap={
"Constants" : [
           [0, 0, 1]
         ],

                }
transientCoeffMap={
"Data" : [
           [9, 2, 10]
         ],
"Constants" : [
               [0,0,1],
               [0,1,1]
               ]
} 
                   
##TODO
segmentDefinitions = [
#  friendly name     , input data ref, offset in input, range of values (order relates to coeff order in segmentCoeffMap)
 {'Name': 'Income 5 segment', 'DataRef': 'Data','Offset': 6, 'DataRange': [0,1,2,3,4]},
 {'Name': 'Parent Tour Mode', 'DataRef': 'Data','Offset': 7, 'DataRange': [1, 2, 3, 4, 5, 6, 7, 8,]},
 {'Name': 'Person Type', 'DataRef': 'Data','Offset': 8, 'DataRange': [1,2,3,4,5,6,7,8,]},
]

segmentCoeffMap = [
{'Segment': 0, 'Vector': 'durable', 'Offset': 0,  # hhinc5s
  'Coefficients':
    [# <25      25-50    50-75    75-100  >100
	[ 0.00000, 0.00000, 0.00000, 0.00000, 0.00000 ], # 0
	[ 0.00000, 0.00000, 0.00000, 0.00000, 0.12008 ], # 1
	[ 0.00000, 0.00000, 0.00000, 0.00000, 0.12008 ], # 2
	[ 0.00000, 0.00000, 0.00000, 0.00000, 0.12008 ], # 3
	[ 0.00000, 0.00000, 0.00000, 0.00000, 0.12008 ], # 4
	[ 0.00000, 0.00000, 0.00000, 0.00000, 0.24017 ], # 5
	[ 0.00000, 0.00000, 0.00000, 0.00000, 0.40901 ], # 6
	[ 0.00000, 0.00000, 0.00000, 0.00000, 0.52910 ], # 7
	[ 0.00000, 0.00000, 0.00000, 0.00000, 0.24017 ], # 8
	[ 0.00000, 0.00000, 0.00000, 0.00000, 0.24017 ], # 9
	[ 0.00000, 0.00000, 0.00000, 0.00000, 0.52910 ], # 10
	[ 0.00000, 0.00000, 0.00000, 0.00000, 0.12008 ], # 11
	[ 0.00000, 0.00000, 0.00000, 0.00000, 0.24017 ], # 12
	[ 0.00000, 0.00000, 0.00000, 0.00000, 0.24017 ], # 13
	[ 0.00000, 0.00000, 0.00000, 0.00000, 0.24017 ], # 14
	[ 0.00000, 0.00000, 0.00000, 0.00000, 0.24017 ], # 15
	[ 0.00000, 0.00000, 0.00000, 0.00000, 0.52910 ], # 16
	[ 0.00000, 0.00000, 0.00000, 0.00000, 0.24017 ], # 17
	[ 0.00000, 0.00000, 0.00000, 0.00000, 0.52910 ], # 18
	[ 0.00000, 0.00000, 0.00000, 0.00000, 0.52910 ], # 19
    ]
},

{'Segment': 1, 'Vector': 'transient', 'Offset': 0,  # ParentTourMode
  'Coefficients':
    [# Dr. Alone     SR2     SR3     WalkTr   DrvTr    Walk     Bike    SchoolBus
		[ 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000 ], # 0
		[ 0.38087, 0.41779, 0.41779, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000 ], # 1
		[ 0.00000, 0.41779, 0.41779, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000 ], # 2
		[ 0.00000, 0.41779, 0.41779, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000 ], # 3
		[ 0.34048, 0.75014, 0.75014, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000 ], # 4
		[ 0.38087, 0.83557, 0.83557, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000 ], # 5
		[ 0.00000, 0.41779, 0.41779, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000 ], # 6
		[ 0.00000, 0.83557, 0.83557, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000 ], # 7
		[ 0.38087, 0.83557, 0.83557, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000 ], # 8
		[ 0.38087, 2.05127, 2.05127, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000 ], # 9
		[ 0.00000, 0.83557, 0.83557, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000 ], # 10
		[ 0.00000, 1.63349, 1.63349, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000 ], # 11
		[ 0.72135, 1.16793, 1.16793, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000 ], # 12
		[ 0.34048, 1.16793, 1.16793, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000 ], # 13
		[ 0.00000, 0.83557, 0.83557, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000 ], # 14
		[ 0.00000, 0.83557, 0.83557, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000 ], # 15
		[ 0.38087, 0.83557, 0.83557, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000 ], # 16
		[ 0.38087, 0.83557, 0.83557, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000 ], # 17
		[ 0.00000, 0.83557, 0.83557, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000 ], # 18
		[ 0.00000, 2.05127, 2.05127, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000 ], # 19
    ]
},

{'Segment': 2, 'Vector': 'transient', 'Offset': 1,  # Person Type
  'Coefficients':
    [# Ch1     Ch2     Ch3     NWA         SEN     PTW       FTW     AdultStd
	[ 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0, 0, 0.00000], # 0
	[ 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, -1.15393, 0, 0.00000], # 1
	[ 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, -1.54136, 0, 0.00000], # 2
	[ 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, -1.69667, 0, 0.00000], # 3
	[ 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, -0.64269, -0.81383, 0.00000], # 4
	[ 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, -2.85062, 0, 0.00000], # 5
	[ 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, -0.71597, 0, 0.00000], # 6
	[ 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, -1.43195, 0, 0.00000], # 7
	[ 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, -2.30788, 0, 0.00000], # 8
	[ 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, -2.55123, 0, 0.00000], # 9
	[ 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, -2.41265, 0, 0.00000], # 10
	[ 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, -1.39728, 0, 0.00000], # 11
	[ 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, -1.79664, -0.81383, 0.00000], # 12
	[ 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, -1.2854, -0.93018, 0.00000], # 13
	[ 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, -3.39336, 0, 0.00000], # 14
	[ 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, -3.23805, 0, 0.00000], # 15
	[ 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, -1.86991, 0, 0.00000], # 16
	[ 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, -2.69531, 0, 0.00000], # 17
	[ 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, -2.25734, 0, 0.00000], # 18
	[ 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, -2.11326, 0, 0.00000], # 19
   ]
}

]